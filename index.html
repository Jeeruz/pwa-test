<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Christmas Countdown PWA</title>
    
    <link rel="manifest" href="/pwa-test/manifest.json">
    <meta name="theme-color" content="#b3000c">
    
    <style>
        :root { --gold: #ffd700; --berry: #b3000c; --forest: #0a4d26; }
        body {
            background: radial-gradient(circle, var(--forest) 0%, #052914 100%);
            color: #fff;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            text-align: center;
        }
        h1 { font-size: 2.5rem; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); color: var(--gold); }
        #timer { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; }
        .time-box {
            background: var(--berry);
            padding: 20px;
            border-radius: 15px;
            min-width: 80px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
            border: 2px solid var(--gold);
        }
        .time-box span { display: block; font-size: 3rem; font-weight: 900; line-height: 1; }
        .label { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; margin-top: 5px; opacity: 0.9; }
        .snow { position: absolute; top: -10px; color: white; user-select: none; z-index: -1; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(105vh); } }
    </style>
</head>
<body>

    <h1>ðŸŽ„ Days Until Christmas</h1>
    
    <div id="timer">
        <div class="time-box"><span id="days">00</span><div class="label">Days</div></div>
        <div class="time-box"><span id="hours">00</span><div class="label">Hrs</div></div>
        <div class="time-box"><span id="minutes">00</span><div class="label">Min</div></div>
        <div class="time-box"><span id="seconds">00</span><div class="label">Sec</div></div>
    </div>

    <script>
        // --- COUNTDOWN LOGIC ---
        function updateCountdown() {
            const now = new Date();
            const year = now.getFullYear();
            let xmas = new Date(`December 25, ${year} 00:00:00`);
            if (now > xmas) { xmas = new Date(`December 25, ${year + 1} 00:00:00`); }
            const diff = xmas - now;
            const d = Math.floor(diff / (1000 * 60 * 60 * 24));
            const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const m = Math.floor((diff / 1000 / 60) % 60);
            const s = Math.floor((diff / 1000) % 60);
            document.getElementById('days').innerText = d.toString().padStart(2, '0');
            document.getElementById('hours').innerText = h.toString().padStart(2, '0');
            document.getElementById('minutes').innerText = m.toString().padStart(2, '0');
            document.getElementById('seconds').innerText = s.toString().padStart(2, '0');
        }

        function createSnow() {
            const flake = document.createElement('div');
            flake.classList.add('snow');
            flake.innerHTML = 'â„';
            flake.style.left = Math.random() * 100 + 'vw';
            flake.style.animationDuration = Math.random() * 3 + 2 + 's';
            flake.style.opacity = Math.random();
            flake.style.fontSize = Math.random() * 10 + 10 + 'px';
            document.body.appendChild(flake);
            setTimeout(() => flake.remove(), 5000);
        }

        setInterval(updateCountdown, 1000);
        setInterval(createSnow, 200);
        updateCountdown();

        // --- CORRECTED SERVICE WORKER REGISTRATION ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Pointing specifically to your repo subfolder
                navigator.serviceWorker.register('/pwa-test/sw.js', { scope: '/pwa-test/' })
                    .then(reg => console.log('PWA: Service Worker Registered!', reg))
                    .catch(err => console.error('PWA: Registration Failed:', err));
            });
        }
    </script>
</body>
</html>
